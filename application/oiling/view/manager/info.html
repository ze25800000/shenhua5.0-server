<?php require(APP_PATH.'/oiling/view/manager/common/header.html');?>
<div id="container">
    <div id="hd">
        <div class="hd-wrap ue-clear">
            <div class="top-light"></div>
            <h1 class="logo"></h1>
            <div class="login-info ue-clear">
                <div class="welcome ue-clear">欢迎您,&nbsp;*{$account}</div>
            </div>
            <div class="toolbar ue-clear">
                <a href="/" class="home-btn">首页</a>
                <a href="javascript:;" class="quit-btn exit"></a>
            </div>
        </div>
    </div>
    <div id="bd">
        <div class="wrap ue-clear">
            <div class="sidebar">
                <h2 class="sidebar-header"><p>功能导航</p></h2>
                <ul class="nav">
                    <li class="office">
                        <div class="nav-header"><a href="standard" class="ue-clear"><span>设备润滑标准</span><i
                                class="icon"></i></a></div>
                    </li>
                    <li class="gongwen current">
                        <div class="nav-header"><a href="info" class="ue-clear"><span>润滑提示与记录</span><i
                                class="icon"></i></a></div>
                    </li>
                    <li class="nav-info">
                        <div class="nav-header"><a href="analysis" class="ue-clear"><span>油脂化验指标分析</span><i
                                class="icon"></i></a></div>
                    </li>
                    <li class="konwledge">
                        <div class="nav-header"><a href="oildetail" class="ue-clear"><span>润滑保养成本管理</span><i
                                class="icon"></i></a></div>
                    </li>
                </ul>
            </div>
            <div class="content">
                <div class="title">
                    <h2>润滑提示与记录</h2>
                    <div class="uploader orange info">
                        <form>
                            <span>批量上传运行时间或消警记录：</span>
                            <select name="">
                                <option value="exceltype=workhour">运行时间</option>
                                <option value="exceltype=infowarning">消警记录</option>
                            </select>
                            <a href="javascript:;" class="a-upload">
                                <input type="file" name="excel" id=""><span class="showFileName">点击这里上传文件</span>
                            </a>
                            <input type="button" name="file" data-param="exceltype=oilstandard"
                                   class="button upload" value="上传"/>
                        </form>
                    </div>
                </div>
                <div class="table-box">
                    <div class="scroll-box" style="overflow: hidden;overflow-y: a">
                        <table>
                            <thead>
                            <tr>
                                <th class="num">
                                    选择
                                </th>
                                <th class="time">润滑点（全称）</th>
                                <th class="process">上次消警时间</th>
                                <th class="process">消警类型</th>
                                <th class="process">运行时长</th>
                                <th class="process">延期时长</th>
                                <th class="process">当前状态</th>
                                <th class="process">是否首保</th>
                                <th class="operate">操作</th>
                            </tr>
                            </thead>
                            <tbody id="infoTbody">
                            <script type="text/html" id="infoTemp">
                                {{each data}}
                                <tr>
                                    <td class="num">
                                        <input type="checkbox">
                                    </td>
                                    <td class="process">${$value.equ_oil_name}</td>
                                    <td class="time">${$value.del_warning_time}</td>
                                    <td class="process">${$value.warning_type}</td>
                                    <td class="process">${$value.how_long}</td>
                                    <td class="process">${$value.postpone}</td>
                                    <td class="process">${$value.status}</td>
                                    <td class="process">${$value.is_first_period}</td>
                                    <td class="operate table-operate">
                                        <a href="#" class="check">润滑</a>
                                        <a href="#" class="edit">延期</a>
                                    </td>
                                </tr>
                                {{/each}}
                            </script>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="ft" class="ue-clear">
        <div class="ft-left">
            <span>神华集团</span>
            <em>设备润滑管理系统</em>
        </div>
        <div class="ft-right">
            <span>非同科技</span>
            <em>2017</em>
        </div>
    </div>
</div>

<?php require(APP_PATH.'/oiling/view/manager/common/exitDialog.html');?>
<?php require(APP_PATH.'/oiling/view/manager/common/footer.html');?>
<script src="__JS__/data.js"></script>
<script>
    $(function () {
        $(document).ready(function () {
            var params = {
                url: 'oiling/info/getlist/1',
                sCallback: function (data) {
                    console.log(data);
                    var list = data.data;
                    for (var i = 0; i < list.length; i++) {
                        var time = new Date(data.data[i]['del_warning_time'] * 1000);

                        data.data[i]['del_warning_time'] = formatDate(time, 'yyyy年MM月dd日');
                        data.data[i]['is_first_period'] = data.data[i]['is_first_period'] ? '是' : '否';
                        data.data[i]['postpone'] = data.data[i]['postpone'] ? data.data[i]['postpone'] : 0;
                        data.data[i]['status'] = data.data[i]['status'] === 3 ? '超期' : (data.data[i]['status'] === 2 ? '延期' : '正常');
                        data.data[i]['warning_type'] = data.data[i]['warning_type'] ? '润滑' : '延期';
                    }
                    $('#infoTemp').tmpl(data).appendTo('#infoTbody');
                    $("tbody").find("tr:odd").css("backgroundColor", "#eff6fa");
                }
            };
            window.base.getData(params);
        })

    });
</script>